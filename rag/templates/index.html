
    <!DOCTYPE html>
    <html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <title>æ™ºèƒ½æ–‡æ¡£é—®ç­”åŠ©æ‰‹</title>
        <style>
            body { 
                font-family: Arial, sans-serif; 
                max-width: 800px; 
                margin: 0 auto; 
                padding: 20px; 
            }
            #chat-container {
                border: 1px solid #ddd;
                min-height: 300px;
                max-height: 500px;
                overflow-y: auto;
                padding: 10px;
                margin-bottom: 10px;
            }
            #query-input {
                width: 100%;
                padding: 10px;
                margin-bottom: 10px;
            }
            #upload-file {
                margin-bottom: 10px;
            }
        </style>
    </head>
    <body>
        <h1>ğŸ“š æ™ºèƒ½æ–‡æ¡£é—®ç­”åŠ©æ‰‹</h1>
        
        <div>
            <input type="file" id="upload-file" accept=".txt,.pdf,.docx">
            <button onclick="uploadDocument()">ä¸Šä¼ æ–‡æ¡£</button>
        </div>
        
        <div id="chat-container"></div>
        
        <input type="text" id="query-input" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜">
        <button onclick="queryDocuments()">è·å–ç­”æ¡ˆ</button>

        <script>
            function addMessage(message, type) {
                const chatContainer = document.getElementById('chat-container');
                const messageElement = document.createElement('div');
                messageElement.classList.add(type);
                messageElement.textContent = message;
                chatContainer.appendChild(messageElement);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            function queryDocuments() {
                const queryInput = document.getElementById('query-input');
                const query = queryInput.value.trim();
                
                if (!query) {
                    alert('è¯·è¾“å…¥é—®é¢˜');
                    return;
                }

                addMessage('æ‚¨: ' + query, 'user-message');

                fetch('/query', {
                    method: 'POST',
                    body: new URLSearchParams({query: query}),
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        addMessage('é”™è¯¯: ' + data.error, 'error-message');
                    } else {
                        addMessage('åŠ©æ‰‹: ' + data.answer, 'assistant-message');
                    }
                })
                .catch(error => {
                    addMessage('é”™è¯¯: ' + error, 'error-message');
                });

                queryInput.value = '';
            }

            function uploadDocument() {
                const fileInput = document.getElementById('upload-file');
                const file = fileInput.files[0];

                if (!file) {
                    alert('è¯·é€‰æ‹©æ–‡ä»¶');
                    return;
                }

                const formData = new FormData();
                formData.append('file', file);

                fetch('/upload', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        addMessage('ä¸Šä¼ é”™è¯¯: ' + data.error, 'error-message');
                    } else {
                        addMessage('æ–‡æ¡£ä¸Šä¼ æˆåŠŸ: ' + file.name, 'system-message');
                    }
                })
                .catch(error => {
                    addMessage('ä¸Šä¼ é”™è¯¯: ' + error, 'error-message');
                });

                fileInput.value = '';
            }
        </script>
    </body>
    </html>
    